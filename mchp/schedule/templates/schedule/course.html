{% extends 'schedule/base.html' %}

{% block head_title %}Course{% endblock %}

{% block extra_head %}
<meta property="fb:app_id" content="369999156462705" /> 
<meta property="og:type" content="website" /> 
<meta property="og:title" content="{{course.dept}} {{course.course_number}} at {{course.domain.name}}" /> 
<meta property="og:image" content="https://s3-us-west-2.amazonaws.com/mchpstatic/Flat+Icon+SVG/SVG/book.png" /> 
<meta property="og:description" content="{{student_count}} Student{{student_count|pluralize}} &nbsp; {{doc_count}} Document{{doc_count|pluralize}} &nbsp; {{cal_count}} Calendar{{cal_count|pluralize}}" />

	{% load staticfiles %}
	<link rel="stylesheet" type="text/css" href="{% static 'schedule/css/course.css' %}">
	<script src="{% static 'schedule/js/course.js' %}"></script>
	<script src="{% static 'schedule/js/course_detail.js' %}"></script>
	<script src="{% static 'lib/js/jquery.cookie.js' %}"></script>
{% endblock %}

{% block body %}
{% load humanize %}
<div class="row">
	<div class="col-xs-12">
		<ol class="breadcrumb opa">
			<h4>You are currently viewing documents for all <strong>{{course.dept}} {{course.course_number}}</strong> courses at <a href="{%url "school" course.domain.pk%}{{course.domain.name}}" class="link"><strong>{{course.domain.name}}</strong></a></h4>
		</ol>
		<div class="well opa" style="padding-bottom:0px;">
			<div class="panel opa">
				<div class="panel-body">
					<div class="media">
					  <div class="media-left media-middle">
					      <div class="media-object"><i class="fa fa-book fa-fw fa-5x"></i></div>
					  </div>
					  <div class="media-body">
					    <h2 class="media-heading">{{course.dept}} {{course.course_number}} at <a class="link" href='{% url "school" course.domain.pk %}{{ course.domain.name}}'>{{course.domain.name}}</a></h2>
					    <small class="pull-right">
								{% if student and enrolled %}
								<button class="btn btn-trans disabled"><i class="fa fa-check"></i> Enrolled</button>
								{% endif %}
							</small>
					    <p>
								<i class="fa fa-users"></i> {{student_count}} Student{{student_count|pluralize}} &nbsp;
								<i class="fa fa-file-text-o"></i> {{doc_count}} Document{{doc_count|pluralize}} &nbsp;
								<i class="fa fa-calendar"></i> {{cal_count}} Calendar{{cal_count|pluralize}} &nbsp;
							</p>
							<div class="progress" style="width:68%;">
								<div class="progress-bar progress-bar-info" data-toggle="tooltip" data-original-title="{{student_count}} Student{{student_count|pluralize}}" data-placement="bottom" style="width: {{student_percent}}%"> <span class="sr-only">{{student_percent}}% Students</span> </div>
								<div class="progress-bar progress-bar-primary" data-toggle="tooltip" data-original-title="{{doc_count}} Document{{doc_count|pluralize}}" data-placement="bottom" style="width: {{doc_percent}}%"> <span class="sr-only">{{doc_percent}}% Documents</span> </div>
								<div class="progress-bar progress-bar-warning" data-toggle="tooltip" data-original-title="{{cal_count}} Calendar{{cal_count|pluralize}}" data-placement="bottom" style="width: {{cal_percent}}%"> <span class="sr-only">{{cal_percent}}% Calendars</span> </div>
							</div>
					  </div>
					</div>
				</div>
			</div>
		</div>
	</div>
	<div class='col-xs-12'>
		<h3><i class="fa fa-file-text-o"></i> Popular Documents <span class="badge opa">{{popular_documents|length}}</span> <a button type="button" class="btn btn-trans btn-sm pull-right" href="{%url "document_upload"%}"><i class="fa fa-money fa-fw"></i> Sell Study Guides</a></h3>
		<p></p>
		<div class="panel opa" id="popular-documents">
			<div class="panel-body">
				<div class="list-group item-list trans">
					{% for document in popular_documents %}
										<div class="list-group-item opa">
						<div class="media">
							<div class="media-left media-middle">
			      		{% if document.preview %}
								<a href="{%url "document_detail" document.uuid %}"><img src="{{document.preview.url}}" class="media-object img-thumbnail" style="width:70px" alt="Study Guide"></a>
								{% else %}
								<a href="{%url "document_detail" document.uuid %}"><img class="media-object img-thumbnail" id="preview_image_{{document.pk}}" src="{% static 'documents/img/loading_file.svg'%}" style="width:70px" alt="Study Guide"></a>
								{% endif %}
				  		</div>
				  		<div class="media-body">
				    		<h2 class="media-heading"><a href="{%url "document_detail" document.uuid %}">{{document.title}}</a>
				    			<small class="white">{{document.price}} points</small>
									<small class="pull-right hidden-sm white">{{document.create_date|naturaltime}}</small>
								</h2>
								<span class="description">
									<strong>Instr {{document.course.professor}}</strong>
									<i class="fa fa-fw fa-thumbs-up text-success"></i>{{document.up}} 
									<i class="fa fa-fw fa-thumbs-down text-danger"></i>{{document.down}}&nbsp;
									{% with document.review_count as review_count %}
									<i class="fa fa-comments text-info fa-fw"></i>{{review_count}} Review{{review_count|pluralize}}&nbsp;
									{% endwith %}
									<i class="fa fa-fw fa-money text-success"></i> {{document.sold}}
									Purchase{{document.sold|pluralize}}
									{% with document.upload.owner as owner %}
									{% if owner %}
									<p class="margin-top-sm">Uploaded by a Student in 
										<!-- <a href="{%url "profile" owner.pk%}">{{owner}}</a> -->
										<a href="{%url "course" document.course.pk%}{{document.course.name}}" class="link">{{document.course.dept}} {{document.course.course_number}}</a>
									</p>
									{% else %}
									<p class="margin-top-sm">Uploaded by Unknown in <a href="{%url "course" document.course.pk%}{{document.course.name}}">{{document.course.dept}} {{document.course.course_number}}</a></p>
									{% endif %}
									{% endwith %}
								</span>
				    	</div>
				    </div>
				  </div>
					{% empty %}
					<div class="list-group">
						<div class="list-group-item">
							<p class="h5">Be the first to sell a document for this class!</p>
							<a button type="button" class="btn btn-trans" href='{% url "document_upload" %}'><i class="fa fa-fw fa-money"></i> Sell Study Guides</a>
						</div>						
					</div>
					{% endfor %}
				</div>
			</div>
		</div>
	</div>
</div>
{% endblock %}
