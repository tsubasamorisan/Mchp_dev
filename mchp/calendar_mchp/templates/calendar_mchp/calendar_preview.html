{% extends 'calendar_mchp/base.html' %}

{% block head_title %}Preview Calendar{% endblock %}

{% block extra_head %}
<script src="//cdnjs.cloudflare.com/ajax/libs/zeroclipboard/2.1.5/ZeroClipboard.js"></script>

{% load staticfiles %}
<link rel="stylesheet" type="text/css" href="{% static 'calendar_mchp/css/calendar_preview.css' %}">
<script src="{% static 'calendar_mchp/js/calendar_preview.js' %}"></script>
{% endblock %}

{% block body %}
{% load humanize %}
{% load referral %}
<div class="container animated bounceInUp">
	<div class="alert alert-info alert-dismissible fade in" role="alert">
		<button type="button" class="close" data-dismiss="alert"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
		<div class="media margin-top-none">
			<img class="media-object pull-left" src="https://s3-us-west-2.amazonaws.com/mchpstatic/Flat+Icon+SVG/SVG/money.svg" alt="earn referral points">
			<div class="media-body">
				<h4 class="media-heading">The easiest way to get <strong>free</strong> points, study guides, and calendars...</h4>
				Is to get your friends to sign up on mchp! Each time you click the <a href="#" 
				class="btn btn-facebook btn-xs fb-share-button">
				<i class="fa fa-fw fa-facebook"></i>Share</a> or the <button data-clipboard-text="#" 
				class="btn btn-warning btn-xs"><i class="fa fa-paperclip fa-fw"></i> Copy link</button>
				<span class="copy-message"></span> buttons, we'll reward you <strong>500 points</strong> for every person that signs up with us by clicking through your links. Remember, the same rules apply when you share your unique referall code and referall link. <strong>- mchp</strong>
			</div>
		</div>
	</div><!-- end alert -->
	<ol class="breadcrumb">
		<h class="pull-right">
			<a href="#flag_doc" data-toggle="modal" class="text-danger small"><i class="fa fa-flag text-danger"></i> Report this Calendar</a> 
		</h>
		<li>
			<a href="{%url "school" calendar.course.domain.pk%}{{calendar.course.domain.name}}"><i class="fa fa-university"></i>&nbsp;{{calendar.course.domain.name}}</a> 
		</li>
		<li>
			<a href="{% url "course" calendar.course.pk%}{{calendar.course.name}}"><i class="fa fa-book">&nbsp;</i>{{calendar.course}}</a> 
		</li>
		<li class="active">
			<a href="{%url "calendar"%}"><i class="fa fa-file-o"></i>&nbsp;{{calendar}}</a>
		</li>
	</ol>
	<div class="well">
		<div class="panel panel-default">
			<div class="panel-body">
				<div class="row">
					<div class="col-sm-5">
						<div class="panel panel-default">
							<div class="panel-body">
								
								<p class="text-center"><strong>Total Events</strong></p>
								<img class="img-circle img-thumbnail center-block text-center" src="https://s3-us-west-2.amazonaws.com/mchpstatic/Circle+Icons+/Custom/calendar-blank.svg" style="width:70px" />
								<p class="assignment-number text-center text-default h4">{{total_count}}</p>
								
								<p class="text-center small">Next event is {{next_event.start|naturaltime}}</p>
								<!-- <ul class="list-inline text-center">
								  <li>Accuracy</li>
								  <li>Last Updated</li>
								  <li>Accuracy</li>
								</ul> -->
								<hr>
								<h5>Previous events: <span class="badge pull-right">{{past_count}}</span></h5>
								<div class="list-group">
									{% for event in events %}
									<div class="list-group-item">
										<strong><i class="fa fa-fw fa-check text-success"></i> {{event.title}}</strong>
										<small class="pull-right">{{event.start|naturaltime}}</small>
									</div>
									{% endfor %}
								</div>
							</div>
						</div>
					</div>
					<div class="col-sm-7">
						<h2 class="margin-top-none margin-btm-sm">{{calendar}} Calendar&nbsp;
							<small class="pull-right">{{calendar.price}} <i class="fa fa-fw fa-lemon-o"></i> /Fortnight</small>
						</h2>
						<h5>
							{% if calendar.accuracy < 0 %}
							<i class="fa fa-fw fa-bullseye text-primary"></i>No Rating&nbsp;
							{% else %}
							<i class="fa fa-fw fa-bullseye text-primary"></i>{{calendar.accuracy}}% Accuracy&nbsp;
							{% endif %}
							{% with calendar.subscribers.count as subscribers %}
							<i class="fa fa-fw fa-money text-success"></i> {{subscribers}} Purchase{{subscribers|pluralize}}&nbsp;
							{% endwith %}
							<i class="fa fa-comments text-info fa-fw"></i> 10 Reviews</h5>
							<ul class="list-inline margin-top small">
							<li><strong>Prof {{calendar.course.professor}}</strong></li> <i class="fa fa-fw fa-clock-o"></i>
							{% for section in calendar.sections %}
							<li class="">
							<span>{{section.day_name|slice:":3"}} {{section.start|time:"fA"}}-{{section.end|time:"fA"}}</span>
						</li>
							{% endfor %}
						</ul>
						<form id="subscribe-form" method="post" action="{{current_path}}">
							{% csrf_token %}
						</form>
						<button form="subscribe-form" class="btn btn-success">
							<i class="fa fa-fw fa-shopping-cart"></i>Subscribe
						</button>
						<a href="{{request.get_host}}{{current_path | referral:referral_link}}" 
						data-title="{{calendar.title}} Calendar" 
						data-desc="{{calendar.description}}" 
						class="btnShare btn btn-facebook fb-share-button">
						<i class="fa fa-fw fa-facebook"></i>Share this</a>
						<button data-clipboard-text="{{request.get_host}}{{current_path | referral:referral_link }}" 
						id="copy-button" class="btn btn-warning"><i class="fa fa-paperclip fa-fw"></i> Copy link</button>
						
						<div class="bs-callout" style="border-top: 0;border-right: 0; border-bottom:0; padding-top:0;">
							<hr>
							<p class="">{{calendar.description}}</p>
							<hr>
							<div class="media">
								<a class="pull-left" href="#">
									<img class="media-object img-circle img-thumbnail" 
									src="{{owner.profile.profile_image_url}}" width="65px">
								</a>
								<div class="media-body">
									<h4 class="media-heading">
										{{owner.name}} <small>Level 8</small>
										<span class="pull-right small">{{calendar.create_date|naturaltime}}</span>
									</h4>
									{% with owner.subscribers.count as subscribers %}
									<p><span class="label label-info">{{subscribers}} Calendar{{subscribers|pluralize}} sold</span> <span
											{% endwith %}
										class="label label-warning">{{owner.rating}}% Avg Rating</span></p>
										<div class="progress margin-btm-none" style="width:68%;">
											<a href="#" class="progress-bar progress-bar-success" id="score_1">
												<span class="sr-only">35% Complete (success)</span>
											</a>
											<a href="#" class="progress-bar progress-bar-primary" id="score_2">
												<span class="sr-only">20% Complete (warning)</span>
											</a>
											<a href="#" class="progress-bar progress-bar-info" id="score_3" >
												<span class="sr-only">45% Complete (danger)</span>
											</a>
										</div>

									</div>
								</div>
							</div>

						</div><!-- end col -->
					</div>
				</div>
			</div><!-- end top panel -->

			<div class="panel panel-default">
				<div class="panel-body">
					<div class="panel panel-default">
						<div class="panel-heading">
							<h3 class="panel-title">Reviews <span class="badge">5</span></h3>
						</div>
						<div class="panel-body">
							<table class="table table-striped table-hover table-responsive">
								<tbody>

									<tr>
										<td>"really good stuff" &nbsp;-
											{% if not request.user.is_anonymous %}
											<a href="#">Mike</a>
											{% else %}
											<a href="#">Anonymous</a>
											{% endif %}
										</td>
										<td>
											<small class="pull-right">20 minutes ago</small>
										</td>
									</tr>

								</tbody>
							</table>
						</div>
					</div><!-- end inner review panel -->
				</div>
			</div><!-- end outer review panel -->
		</div><!-- end well -->
	</div><!-- end container -->
	{% endblock %}
